<!DOCTYPE html>
<html>

<head>
  <title>S P A C E</title>
  <link href="https://fonts.googleapis.com/css?family=Arimo" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Anonymous+Pro:400,700&amp;subset=cyrillic" rel="stylesheet">
  <style type="text/css">
    * {
      transition: all 0.5s;
    }

    body {
      margin: 0;
      box-sizing: border-box;
      height: 100vh;
      transition: all 0.5s ease;
      perspective: 1000px;
      background: #cccccc;
      padding-top: 2vh;
      padding-bottom: 2vh;
      padding-left: 2vw;
      padding-right: 2vw;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .editor-container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: row;
      justify-content: center;
      align-items: center;
    }

    textarea {
      margin: 0;
      padding: 6px;
      border: none;
      width: 25%;
      height: 89vh;
      max-height: 89vh;
      outline: none;
      transition: all 0.5s ease;
      background: #1e1e1e;
      color: #b5cea8;
      font-family: 'Anonymous Pro', monospace;
      font-weight: bold;
      font-size: 14px;
      border-radius: 4px;
    }

    #markup-content {
      transform: rotateY(8deg);
    }

    #style-content {
      transform: rotateY(-8deg);
    }

    #html {
      flex-grow: 1;
      height: 88vh;
      max-height: 88vh;
      border: solid #2d2d30 2px;
      background: white;
      max-width: 45%;
      margin: 0px 8px;
      border-radius: 4px;
      padding: 0px;
      overflow-y: hidden;
    }

    #body {
      width: 100%;
      height: 100%;
      overflow-y: auto;
    }

    #stop-btn {
      color: black;
    }
    .hide {
      width: 0%;
      height: 0%;
      padding: 0;
      overflow: hidden;
      resize: none;
    }
  </style>
  <style id="css" type="text/css"></style>
  <script id="script" type="text/javascript"></script>
</head>

<body>
  <div class="editor-container">
    <textarea disabled id="markup-content"></textarea>
    <div id="html">
      <div id="body"></div>
    </div>
    <textarea disabled id="style-content"></textarea>
  </div>
  <a id="stop-btn" href="javascript:closeit();">skip</a>

  <script type="text/javascript">
    let css = document.getElementById('css');
    let body = document.getElementById('body');
    let script = document.getElementById('script');
    let stopped = false;
    var closeit = function () {
      document.getElementById('stop-btn').style.display = 'none'
      document.getElementById('style-content').className = 'hide';
      document.getElementById('markup-content').className = 'hide';
      document.getElementById('html').style.maxWidth = '100%';
      stopped = true;
    }

    function updateCSS(styleText) {
      css.appendChild(document.createTextNode(styleText));
    }
    function updateBody(markUpText) {
      body.appendChild(document.createRange().createContextualFragment(markUpText));
    }
    function updateScript(scriptText) {
      script.appendChild(document.createTextNode(scriptText));
    }

    function typeit(textarea, text, onTypeEnd) {
      return new Promise((resolve) => {
        let index = 0;
        let next_letter = function () {
          if (index < text.length) {
            textarea.value += text[index++];
            if(stopped) {
              next_letter();
            }else {
              setTimeout(next_letter, 40);              
            }
          } else {
            onTypeEnd(text);
            resolve();
          }
        }
        next_letter();
      });
    }

    async function main() {
      let style = document.getElementById('style-content');
      let markup = document.getElementById('markup-content');

      let snippets = [
        {
          html: ``,
          css: `
/* Say things here.. */
#body {
  background:#ECEFF1;
}
`
        },
        {
          html: `
<!-- Say things here... -->

<h2>Hey,</h2>
`,
          css: `
h2 {
  font-size: 20px;
  color: black;
  font-family: 'Anonymous Pro'
}
`
        },
        {
          html: `
<h1>Lets build something amazing together!</h1>
`,
          css: `
h1 {
  font-size: 28px;
  color: rgba(255,82,82,0.87);
  font-family: 'Anonymous Pro';
}
`
        }];

      for (i = 0; i < snippets.length; ++i) {
        await typeit(markup, snippets[i].html, updateBody);
        await typeit(style, snippets[i].css, updateCSS);
      }
    };
    main();
  </script>
</body>

</html>