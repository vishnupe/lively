<!DOCTYPE html>
<html>

<head>
  <title>S P A C E</title>
  <link href="prism.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css?family=Arimo" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Anonymous+Pro:400,700&amp;subset=cyrillic" rel="stylesheet">
  <style type="text/css">
    * {
      transition: all 0.5s;
    }

    body {
      margin: 0;
      box-sizing: border-box;
      height: 100vh;
      transition: all 0.5s ease;
      perspective: 1000px;
      background: #1e1e1e;
      padding-top: 2vh;
      padding-bottom: 2vh;
      padding-left: 2vw;
      padding-right: 2vw;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .container {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: row;
      align-items: center;
    }

    .editor-container {
      width: 50%;
      position: relative;
      height: 89vh;
      max-height: 89vh;
    }

    .textarea {
      white-space: pre-wrap;
      margin: 0;
      padding: 6px;
      border: none;
      outline: none;
      transition: all 0.5s ease;
      background: #1e1e1e;
      color: #b5cea8;
      font-family: 'Anonymous Pro', monospace;
      font-weight: bold;
      font-size: 14px;
      height: 100%;
      z-index: 1;
    }

    .editor-item {
      position: absolute;
      display: flex;
      flex-direction: column;
      width: 100%;
      height: 100%;
    }

    .tab-list {
      display: flex;
      flex-direction: row;
      justify-content: flex-start;
      width: 100%;
    }

    .tab {
      background: #1e1e1e;
      color: #b5cea8;
      font-family: 'Anonymous Pro', monospace;
      font-weight: bold;
      font-size: 14px;
      height: 30px;
      padding: 8px;
      width: 25%;
      cursor: pointer;
      z-index: 2;
    }

    #editor2>.tab {
      margin-left: 27%;
    }

    .hidden>.textarea {
      z-index: 0;
    }

    .hidden>.tab {
      background: rgb(45, 45, 45);
    }

    #markup-content {
      /*transform: rotateY(8deg);*/
    }

    #style-content {
      /*transform: rotateY(-8deg);*/
    }

    #html {
      flex-grow: 1;
      height: 88vh;
      max-height: 88vh;
      background: white;
      max-width: 45%;
      margin: 0px 8px;
      padding: 0px;
      overflow-y: hidden;
    }

    #body {
      width: 100%;
      height: 100%;
      overflow-y: auto;
    }

    #stop-btn {
      color: black;
    }

    .hide {
      width: 0%;
      height: 0%;
      padding: 0;
      overflow: hidden;
      resize: none;
      display: none;
    }
    /** prism styles **/

    .token.property,
    .token.tag,
    .token.boolean,
    .token.number,
    .token.constant,
    .token.symbol,
    .token.deleted {
      color: #569cd6;
    }
  </style>
  <style id="css" type="text/css"></style>
  <script id="script" type="text/javascript"></script>
  <script src="prism.js" data-manual></script>
</head>

<body>
  <!--<div class="tab-list">
    <div class="tab">mysite.html</div>
    <div class="tab">mysite.css</div>
  </div>-->
  <div class="container">
    <div class="editor-container">
      <div id="editor2" class="editor-item hidden">
        <div class="tab" onclick="selectTab(2)">mysite.css</div>
        <pre class="textarea" disabled id="style-content"></pre>
      </div>
      <div id="editor1" class="editor-item">
        <div class="tab" onclick="selectTab(1)">mysite.html</div>
        <pre class="textarea" disabled id="markup-content"></pre>
      </div>
    </div>
    <div id="html">
      <div id="body"></div>
    </div>
  </div>

  <a id="stop-btn" href="javascript:closeit();">skip</a>

  <script type="text/javascript">
    let css = document.getElementById('css');
    let body = document.getElementById('body');
    let script = document.getElementById('script');

    let style = document.getElementById('style-content');
    let markup = document.getElementById('markup-content');

    let stopped = false;
    var closeit = function () {
      document.getElementById('stop-btn').style.display = 'none'
      document.getElementsByClassName('editor-container')[0].className = 'hide';
      document.getElementById('html').style.maxWidth = '100%';
      stopped = true;
    }
    function selectTab(tab) {
      switch (tab) {
        case 1:
          document.getElementById('editor1').className = 'editor-item';
          document.getElementById('editor2').className = 'editor-item hidden';
          break;
        case 2:
          document.getElementById('editor1').className = 'editor-item hidden';
          document.getElementById('editor2').className = 'editor-item';
          break;
      }
    }
    function updateCSS(styleText, hText) {
      style.innerHTML = '';
      style.appendChild(document.createRange().createContextualFragment(hText));
      css.appendChild(document.createTextNode(styleText));
    }
    function updateBody(markUpText, hText) {
      markup.innerHTML = '';
      markup.appendChild(document.createRange().createContextualFragment(hText));
      body.appendChild(document.createRange().createContextualFragment(markUpText));
    }
    function updateScript(scriptText) {
      script.appendChild(document.createTextNode(scriptText));
    }

    function typeit(textarea, text, onTypeEnd, type) {
      return new Promise((resolve) => {
        let index = 0;
        let hText = textarea.innerHTML +
          '<code>' + Prism.highlight(text, Prism.languages[type]) + '</code>';
        console.log(hText)
        let next_letter = function () {
          if (index < text.length) {
            textarea.innerHTML += text[index++];
            if (stopped) {
              next_letter();
            } else {
              setTimeout(next_letter, 40);
            }
          } else {
            onTypeEnd(text, hText);
            resolve();
          }
        }
        next_letter();
      });
    }

    async function main() {
      let snippets = [
        //         {
        //           html: ``,
        //           css: `
        // /* Say things here.. */
        // #body {
        //   background:#ECEFF1;
        // }
        // `
        //         },
        {
          html: `
<!-- Say things here... -->

<h2>Hey,</h2>
`,
          css: `
h2 {
  font-size: 20px;
  color: black;
  font-family: 'Anonymous Pro'
}
`
        },
        {
          html: `
<h1>Lets build something amazing together!</h1>
`,
          css: `
h1 {
  font-size: 28px;
  color: rgba(255,82,82,0.87);
  font-family: 'Anonymous Pro';
}
`
        }];

      for (i = 0; i < snippets.length; ++i) {
        await typeit(markup, snippets[i].html, updateBody, 'markup');
        await typeit(style, snippets[i].css, updateCSS, 'css');
      }
    };
    main();
  </script>
</body>

</html>